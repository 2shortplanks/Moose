use strict;
use warnings;

BEGIN {
    eval { require ExtUtils::MakeMaker::Dist::Zilla::Develop };
    if ($@) {
        warn
            "You need to install ExtUtils::MakeMaker::Dist::Zilla::Develop to run this Makefile.PL\n";
        exit 1;
    }

    eval { require Test::Inline };
    if ($@) {
        warn "You need to install Test::Inline to run this Makefile.PL\n";
        exit 1;
    }

    ExtUtils::MakeMaker::Dist::Zilla::Develop->import();
}

system( $^X, 'author/extract-inline-tests', '--quiet' );

use lib 'inc';
use MMHelper;

eval MMHelper::my_package_subs();

my %args = MMHelper::mm_args();
$args{clean}{FILES} = join(' ', ($args{clean}{FILES} || ()),
    't/recipes/{a,[c-zA-Z]}*', 't/recipes/basics_[a-fh-zA-Z]*');

WriteMakefile(
    NAME => 'Moose',
    test => { TESTS => 't/*.t t/*/*.t' },
    CCFLAGS => MMHelper::ccflags_static('dev'),
    %args,
);
